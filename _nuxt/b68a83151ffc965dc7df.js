(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{523:function(t,e,r){"use strict";r.r(e);r(22),r(23),r(53),r(18),r(31),r(34),r(168),r(51),r(8),r(5),r(10),r(40);var o=r(15),n=r(20),c=r(28),l=r(27),m=r(26),h=r(19),f=r(17),v=r(54),y=r(445),filter=r(446),d=r(441),_=r(444);function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=Object(h.a)(t);if(e){var n=Object(h.a)(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Object(m.a)(this,r)}}var $=function(t,e,r,desc){var o,n=arguments.length,c=n<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,r):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,r,desc);else for(var i=t.length-1;i>=0;i--)(o=t[i])&&(c=(n<3?o(c):n>3?o(e,r,c):o(e,r))||c);return n>3&&c&&Object.defineProperty(e,r,c),c},w=function(t){Object(l.a)(m,t);var e,r=x(m);function m(){var t;return Object(n.a)(this,m),(t=r.apply(this,arguments)).height=window.innerHeight,t.string="",t.loadingFlag=!1,t.sortLabelsTmp='["基-経典番号", "基-配本"]',t.itemsSort=[],t}return Object(c.a)(m,[{key:"fetch",value:(e=Object(o.a)(regeneratorRuntime.mark((function t(e){var r,o,n,c,l,m,h,f,i,v,y,d,_,x,$,w,k,S,C,F,O,P,j;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.store,null!=(o=r.state).index){t.next=10;break}if(n=e.query.u){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,e.app.$searchUtils.createIndex(n);case 8:c=t.sent,e.app.$searchUtils.initStore(r,c);case 10:if(Object.keys(o.facetLabels)){for(l=r.state.index,m={},h=[],f=Object.keys(l).sort(),i=0;i<f.length;i++)v=f[i],m[v]=v,v.startsWith("_")||h.push(v);r.commit("setFacetLabels",m),r.commit("setFacetFlags",h)}for($ in y=e.query,d=e.app.$searchUtils.createQuery(y,o),r.commit("setQuery",d),_=e.app.$searchUtils.search(r.state.index,r.state.data,r.state.query),e.store.commit("setResult",_),r.commit("init"),(x=y.keyword)&&r.commit("setKeyword",x),y)for(w=["fc","q"],k=0;k<w.length;k++)S=w[k],$.includes(S+"-")&&r.commit("setAdvanced",{label:$,values:y[$],type:S});(C=y.layout)&&r.commit("setLayout",C),(F=y.sort)&&r.commit("setSort",F),(O=y.from)&&r.commit("setFrom",Number(O)),(P=y.size)&&r.commit("setSize",Number(P)),j=o.from/o.size+1,r.commit("setCurrentPage",j),window.scrollTo(0,0);case 31:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"watchLayout",value:function(t){("image"!==t&&"stats"!==t||!this.facetFlag)&&("image"===t||"stats"===t||this.facetFlag)||(this.facetFlag=!this.facetFlag)}},{key:"setCurrentPage",value:function(){if(this.currentPage>0){var t=Object.assign({},this.$route.query);t.from=(this.currentPage-1)*this.size,this.updateQuery(t)}}},{key:"setSize",value:function(){var t=Object.assign({},this.$route.query);t.from=0,t.size=this.size,this.updateQuery(t)}},{key:"setSort",value:function(){var t=Object.assign({},this.$route.query);t.from=0,t.sort=this.sort,this.updateQuery(t)}},{key:"updateQuery",value:function(t){this.$router.push(this.localePath({name:"search",query:t}),(function(){}),(function(){}))}},{key:"memberId",get:function(){return this.$store.state.currentMember},set:function(t){this.$store.commit("setCurrentMember",t)}},{key:"manifest",get:function(){return this.$store.state.currentManifest},set:function(t){this.$store.commit("setCurrentManifest",t)}},{key:"miradorPath",get:function(){var t=this.manifest;if(""===t)return null;var e=[{manifest:t,canvas:this.memberId}];return"/mirador/?params="+encodeURIComponent(JSON.stringify(e))}},{key:"results",get:function(){return this.$store.state.result.hits.hits}},{key:"layouts",get:function(){return[{value:"grid",text:this.$t("grid")},{value:"list",text:this.$t("list")},{value:"image",text:this.$t("thumbnail")},{value:"table",text:this.$t("table")},{value:"stats",text:this.$t("graph")}]}},{key:"currentPage",get:function(){return this.$store.state.currentPage},set:function(t){this.$store.commit("setCurrentPage",t)}},{key:"layout_",get:function(){return this.$store.state.layout},set:function(t){this.$store.commit("setLayout",t)}},{key:"col",get:function(){return this.$store.state.col},set:function(t){this.$store.commit("setCol",t)}},{key:"size",get:function(){return this.$store.state.size},set:function(t){this.$store.commit("setSize",t)}},{key:"sort",get:function(){return this.$store.state.sort},set:function(t){this.$store.commit("setSort",t)}},{key:"facetFlag",get:function(){return this.$store.state.facetFlag},set:function(t){this.$store.commit("setFacetFlag",t)}},{key:"total",get:function(){var t=this.$store.state.result;return t.hits?t.hits.total.value:0}},{key:"paginationLength",get:function(){return Math.ceil(this.total/this.size)}},{key:"computedItemsSort",get:function(){if(!this.$store.state.index)return[];for(var t=[{value:"_score:desc",text:this.$t("relevance")}],e=["asc","desc"],r=Object.keys(this.$store.state.index).sort(),i=0;i<r.length;i++){var o=r[i];if("_full_text"!==o){for(var n=0;n<e.length;n++){var c=e[n],label=o.startsWith("_")?o.slice(1):o;t.push({value:o+".keyword:"+c,text:label+" "+this.$t(c)})}0===i&&null==this.sort&&(this.sort=o+".keyword:asc")}}return t}}]),m}(v.Vue);$([Object(v.Watch)("layout_")],w.prototype,"watchLayout",null);var k=w=$([Object(v.Component)({components:{SearchForm:y.a,SearchFilter:filter.a,FacetSearchOptions:_.a,SearchResult:d.a},watchQuery:!0})],w),S=r(47),C=r(80),F=r.n(C),O=r(172),P=r(423),j=r(408),R=r(157),z=r(515),L=r(424),V=r(420),I=r(45),N=r(506),component=Object(S.a)(k,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("v-sheet",{attrs:{color:"grey lighten-3"}},[r("SearchFilter")],1),t._v(" "),r("v-container",{attrs:{fluid:""}},[r("v-row",{attrs:{dense:""}},[r("v-col",{staticClass:"py-0 my-0",attrs:{cols:"12",sm:"6",lg:"8"}},[r("h2",{staticClass:"my-2",staticStyle:{"vertical-align":"middle"}},[t._v("\n          "+t._s(t.$t("search_result"))+": "+t._s(t.total.toLocaleString())+t._s(t.$t("hits"))+"\n        ")])]),t._v(" "),r("v-col",{staticClass:"py-0 my-0",attrs:{cols:"12",sm:"6",lg:"4"}},[r("v-row",{attrs:{dense:""}},["stats"!==t.layout_?[r("v-col",{staticClass:"py-0 my-0",attrs:{cols:"12",sm:"3"}},[r("v-select",{attrs:{items:t.computedItemsSort,label:t.$t("Sort by")},on:{change:t.setSort},model:{value:t.sort,callback:function(e){t.sort=e},expression:"sort"}})],1),t._v(" "),r("v-col",{staticClass:"py-0 my-0",attrs:{cols:"12",sm:"3"}},[r("v-select",{attrs:{items:[{value:24,text:"24"},{value:60,text:"60"},{value:120,text:"120"},{value:512,text:"512"}],label:t.$t("items_per_page")},on:{change:t.setSize},model:{value:t.size,callback:function(e){t.size=e},expression:"size"}})],1)]:t._e(),t._v(" "),r("v-col",{staticClass:"py-0 my-0",attrs:{cols:"12",sm:"3"}},[r("v-select",{attrs:{items:t.layouts,label:t.$t("layout")},model:{value:t.layout_,callback:function(e){t.layout_=e},expression:"layout_"}})],1),t._v(" "),r("v-col",{directives:[{name:"show",rawName:"v-show",value:("grid"===t.layout_||"image"===t.layout_)&&"xs"!=t.$vuetify.breakpoint.name,expression:"\n              (layout_ === 'grid' || layout_ === 'image') &&\n              $vuetify.breakpoint.name != 'xs'\n            "}],staticClass:"py-0 my-0",attrs:{cols:"12",sm:"3"}},[r("v-select",{attrs:{label:t.$t("col"),items:[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:6,text:"6"},{value:12,text:"12"}]},model:{value:t.col,callback:function(e){t.col=e},expression:"col"}})],1)],2)],1)],1),t._v(" "),r("v-row",[r("v-col",{attrs:{cols:"12",sm:t.facetFlag?8:12,md:t.facetFlag?9:12,"order-sm":"12"}},[t._e(),t._v(" "),t.total>0?[r("v-row",[r("v-col",{attrs:{cols:"12",sm:""!=t.manifest?6:12}},[r("div",{staticClass:"overflow-y-auto",style:"max-height : "+t.height+"px"},[r("div",{staticClass:"text-center my-5"},[r("v-pagination",{directives:[{name:"show",rawName:"v-show",value:"stats"!==t.layout_&&"map"!==t.layout_,expression:"layout_ !== 'stats' && layout_ !== 'map'"}],attrs:{length:t.paginationLength,"total-visible":7},on:{input:t.setCurrentPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1),t._v(" "),r("SearchResult"),t._v(" "),r("div",{staticClass:"text-center my-5"},[r("v-pagination",{directives:[{name:"show",rawName:"v-show",value:"stats"!==t.layout_&&"map"!==t.layout_,expression:"layout_ !== 'stats' && layout_ !== 'map'"}],attrs:{length:t.paginationLength,"total-visible":7},on:{input:t.setCurrentPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)]),t._v(" "),""!=t.manifest?r("v-col",{attrs:{cols:"12",sm:""!=t.manifest?6:0}},[r("div",{staticClass:"text-right"},[r("v-btn",{staticClass:"mb-2",on:{click:function(e){t.manifest="",t.memberId=""}}},[t._v(t._s(t.$t("close")))])],1),t._v(" "),r("iframe",{staticStyle:{border:"none"},attrs:{src:t.miradorPath,seamless:"seamless",width:"100%",height:t.height+"px",allow:"fullscreen"}})]):t._e()],1)]:t._e()],2),t._v(" "),r("v-col",{attrs:{sm:4,md:3,"order-sm":"1"}},[r("div",{staticClass:"overflow-y-auto",style:"max-height : "+t.height+"px"},[t.total>0?[r("h3",{staticClass:"mb-0"},[r("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[r("v-icon",t._g({on:{click:function(e){t.facetFlag=!t.facetFlag}}},o),[t._v(t._s(t.facetFlag?"mdi-arrow-collapse-left":"mdi-arrow-collapse-right"))])]}}],null,!1,361303484)},[t._v(" "),r("span",[t._v(t._s(t.facetFlag?t.$t("close_facets"):t.$t("open_facets")))])]),t._v("\n              "+t._s(t.$t("refine_your_search"))+"\n            ")],1),t._v(" "),r("FacetSearchOptions",{directives:[{name:"show",rawName:"v-show",value:t.facetFlag,expression:"facetFlag"}],staticClass:"mt-5"})]:t._e()],2)])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;F()(component,{VBtn:O.a,VCol:P.a,VContainer:j.a,VIcon:R.a,VPagination:z.a,VRow:L.a,VSelect:V.a,VSheet:I.a,VTooltip:N.a})}}]);